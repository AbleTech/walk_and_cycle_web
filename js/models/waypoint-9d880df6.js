!function(){var t,e,n=function(t,e){return function(){return t.apply(e,arguments)}},o={}.hasOwnProperty,r=function(t,e){function n(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};JourneyPlanner.Models.Waypoint=function(e){function o(){return this.updateWaypoint=n(this.updateWaypoint,this),t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.defaults=function(){return{a:"",x:"",y:""}},o.prototype.getMarker=function(){return null!=this._marker?this._marker:(this._marker=new google.maps.Marker({icon:this.iconStyle(),title:this.get("a"),position:this.getLatLng(),draggable:!0}),google.maps.event.addListener(this._marker,"dragend",this.updateWaypoint),this._marker)},o.prototype.index=function(){return this.collection.indexOf(this)},o.prototype.iconStyle=function(){switch(this.get("type")){case"start":return{url:"img/waypoint_markers/start.png",scaledSize:new google.maps.Size(52,27),anchor:new google.maps.Point(19,27)};case"via":return{url:"img/waypoint_markers/via.png",scaledSize:new google.maps.Size(40,27),anchor:new google.maps.Point(14,27)};case"end":return{url:"img/waypoint_markers/end.png",scaledSize:new google.maps.Size(41,27),anchor:new google.maps.Point(14,27)};default:return{}}},o.prototype.getLatLng=function(){return this._latlng||(this._latlng=new google.maps.LatLng(this.get("y"),this.get("x")))},o.prototype.streetName=function(){return this.get("a").split(",")[0]},o.prototype.queryStr=function(){return"waypoints["+this.index()+"][a]="+escape(this.get("a"))+"&waypoints["+this.index()+"][x]="+escape(this.get("x"))+"&waypoints["+this.index()+"][y]="+escape(this.get("y"))},o.prototype.validate=function(t){var e;return e=[],t.x||e.push("missing x coordinate"),t.y?void 0:e.push("missing y coordinate")},o.prototype.updateWaypoint=function(){var t,e=this;return t=this.getMarker().getPosition(),AddressService.ClosestAddress.find(t.lat(),t.lng(),function(t){return t?(e.set({a:t.a,x:t.x,y:t.y}),e.trigger("update_point")):void 0})},o}(Backbone.Model),JourneyPlanner.Collections.Waypoints=function(t){function n(){return e=n.__super__.constructor.apply(this,arguments)}return r(n,t),n.prototype.model=JourneyPlanner.Models.Waypoint,n}(Backbone.Collection)}.call(this);