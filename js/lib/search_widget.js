!function(){var e={}.hasOwnProperty,t=function(t,r){function n(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return n.prototype=r.prototype,t.prototype=new n,t.__super__=r.prototype,t};define(["jquery"],function(e){return window.SearchWidget=function(r){function n(e,t){var r=this;t.manual_style=!0,null==t.address_params&&(t.address_params={}),t.address_params.region_code="F",n.__super__.constructor.call(this,e,"d1707a90-fd84-012c-d9c3-00e08121877f",t),this.prefix=t.prefix,this.on("address:select",function(e,t){return r.populateFields(e,t.x,t.y)}),this.on("location:select",function(e,t){return r.populateFields(e,t.x,t.y)}),this.addPOIService(),Modernizr.geolocation&&this.addGPSService()}return t(n,r),n.prototype.populateFields=function(t,r,n){return e("#"+this.prefix+"_a").val(t),e("#"+this.prefix+"_x").val(r),e("#"+this.prefix+"_y").val(n)},n.prototype.addPOIService=function(){var t=this;return this.poi_service=this.addService("poi-location",function(t,r){return e.getJSON("http://jp-poi-search.journeyplanner.org.nz/search?callback=?",{q:t},function(e){var n,i;return i=function(){var t,r,i,o;for(i=e.results.slice(0,5),o=[],t=0,r=i.length;r>t;t++)n=i[t],o.push({value:n.a,data:n});return o}(),r(t,i)})}),this.poi_service.on("result:select",function(e,r){return t.populateFields(e,r.x,r.y)})},n.prototype.addGPSService=function(){var e=this;return this.gps_service=this.addService("gps-location",function(e,t){var r;return _.str.include("current location",e.toLowerCase())&&(r=[{value:"Current Location"}]),t(e,r||[])}),this.gps_service.setOption("renderer",function(){return"<i class='icon-screenshot'></i> Current Location"}),this.gps_service.on("result:select",function(){return navigator.geolocation.getCurrentPosition(function(t){return e.populateFields("Current Location",t.coords.longitude,t.coords.latitude)})})},n}(AddressFinder.Widget)})}.call(this);