!function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t={}.hasOwnProperty,r=function(e,r){function a(){this.constructor=e}for(var p in r)t.call(r,p)&&(e[p]=r[p]);return a.prototype=r.prototype,e.prototype=new a,e.__super__=r.prototype,e};define(["jquery","app/collections/points_of_interest","jquery.cookie"],function(t,a){var p;return p=function(p){function o(r){this.updateMaptype=e(this.updateMaptype,this),this.updateOverlay=e(this.updateOverlay,this);var a=this;o.__super__.constructor.call(this,r,this.map_opts),google.maps.event.addListener(this,"maptypeid_changed",function(){return t.cookie("jp_maptype",a.getMapTypeId(),{path:"/",expires:365})}),this.setupLayers()}return r(o,p),o.prototype.map_opts={center:new google.maps.LatLng(-41.105,175.288),zoom:9,mapTypeId:t.cookie("jp_maptype")||google.maps.MapTypeId.ROADMAP,scaleControl:!0,mapTypeControl:!1},o.prototype.setupLayers=function(){return this.pois=new a,this.weather_layer=new google.maps.weather.WeatherLayer({temperatureUnits:google.maps.weather.TemperatureUnit.CELCIUS}),this.bike_layer=new google.maps.KmlLayer("http://journeyplanner.org.nz/mobile_combined-0.2.1.kml",{clickable:!1,preserveViewport:!0,suppressInfoWindows:!0}),this.traffic_layer=new google.maps.TrafficLayer},o.prototype.updateOverlay=function(e){var r,a;return null!=(r=this.current_overlay)&&r.setMap(null),this.current_overlay=function(){switch(e){case"paths":return this.bike_layer;case"poi":return this.pois;case"traffic":return this.traffic_layer;case"weather":return this.weather_layer}}.call(this),null!=(a=this.current_overlay)&&a.setMap(this),t.cookie("jp_overlay",e,{path:"/",expires:365})},o.prototype.updateMaptype=function(e){var t;return t=function(){switch(e){case"map":return google.maps.MapTypeId.ROADMAP;case"terrain":return google.maps.MapTypeId.TERRAIN;case"aerial":return google.maps.MapTypeId.HYBRID}}(),this.setMapTypeId(t)},o}(google.maps.Map)})}.call(this);